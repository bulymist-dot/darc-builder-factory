<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>D'ARC APK FACTORY</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; padding: 20px; text-align: center; }
        .box { border: 2px solid #238636; padding: 20px; border-radius: 10px; background: #111; max-width: 500px; margin: auto; }
        textarea { width: 100%; height: 250px; background: #000; color: #0f8; border: 1px solid #333; margin: 15px 0; border-radius: 5px; box-sizing: border-box; }
        button { background: #238636; color: white; border: none; padding: 20px; width: 100%; font-weight: bold; cursor: pointer; border-radius: 5px; text-transform: uppercase; }
        #log { margin-top: 15px; color: #888; font-size: 12px; background: #222; padding: 10px; border-radius: 5px; display: none; }
    </style>
</head>
<body>
    <div class="box">
        <h2 style="color: #58a6ff;">üöÄ F√ÅBRICA D'ARC ONLINE</h2>
        <p style="font-size: 11px;">O c√≥digo ser√° enviado para: <b>Darc-ia/darc-builder-factory</b></p>
        
        <textarea id="code" placeholder="Cole o c√≥digo HTML do seu App aqui..."></textarea>
        
        <button onclick="gerarAPK()">FABRICAR MEU APK AGORA</button>
        
        <div id="log"></div>
    </div>

    <script>
        async function gerarAPK() {
            // DADOS EXTRA√çDOS DOS SEUS PRINTS
            const token = "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"; 
            const user = "Darc-ia"; 
            const repo = "darc-builder-factory";
            
            const code = document.getElementById('code').value;
            const log = document.getElementById('log');

            if(!code) return alert("Cole o c√≥digo primeiro!");

            log.style.display = "block";
            log.innerText = "‚è≥ Conectando ao reposit√≥rio Darc-ia...";

            try {
                // Busca o arquivo index.html atual para conseguir o SHA
                const res = await fetch(`https://api.github.com/repos/${user}/${repo}/contents/index.html`, {
                    headers: { "Authorization": `token ${token}` }
                });
                
                if(!res.ok) throw new Error("Arquivo index.html n√£o encontrado no GitHub. Crie ele primeiro!");
                
                const data = await res.json();

                // Envia o novo c√≥digo para o GitHub
                log.innerText = "‚è≥ Enviando c√≥digo e disparando o servidor de APK...";
                const put = await fetch(`https://api.github.com/repos/${user}/${repo}/contents/index.html`, {
                    method: "PUT",
                    headers: { "Authorization": `token ${token}`, "Content-Type": "application/json" },
                    body: JSON.stringify({
                        message: "Build APK via Painel Darc",
                        content: btoa(unescape(encodeURIComponent(code))), 
                        sha: data.sha
                    })
                });

                if(put.ok) {
                    log.innerHTML = "<b style='color:#0f8'>‚úÖ ENVIADO COM SUCESSO!</b><br><br>1. V√° no seu GitHub em 'Actions'.<br>2. Espere 3 minutos ficar verde.<br>3. Baixe o 'app-debug' no final da p√°gina.";
                } else {
                    log.innerText = "‚ùå Erro ao enviar c√≥digo. Verifique se o Token ainda √© v√°lido.";
                }
            } catch (e) {
                log.innerText = "‚ùå ERRO: " + e.message;
            }
        }
    </script>
</body>
</html>
